#m2=2
#c2=2^e
#计算X = (C × 2^e)mod n
#将X作为选择明文提交，并收到Y = X^d mod n。
#因此：
#X = (C mod n) × (2^e mod n) = (M^e mod n) × (2 ^e mod n) = (2M)^e mod n

#因此：
#Y = (2M) mod n
#就这样，我们获得了M。


import libnum
import gmpy2
n = 413141504084725947748587668933528684105821547979327246497895115950474578394168748004829879879660621384518537400326124785651247346763189335226759761438718011303524611462773174636784142753807862808251846096706535580368644882611139986917945303159992465883303193772647810515207237805143422465721044287453362332662098905556519848188600825102625893200620478964949175859612875367795248539001122922794848261448070975085172596382262924357931588900396097512947379575634934317518648260023810637377370955988362073883126855186819687548213462959363535618493463740569578406699383143591982167063097475419727239969949969593404275967633075629047592722151808119173885346341928344582586560385198546835848646020080756941466204526411064297927400296227965489534170236330269455582844111742680349
e = 65537
c = 106792938421684371475002815405229949926931261294069008012440126268358781085124403674911763352581288134984865957037041485808228928794237949436380407032029047487300492482006051821932009923851124895231451414090624237214942187171265205488770990169258716898907856628372685765359554441714083330667769362906237531833435973493944940541178582144230546586662998804422117669522172267165366481131901611269119039533541286683283988553230969347788450412833627556520844752960049930263515868610547756150559729812134918469054486340740367074445379779912060639769427029034787963266404448249689826384802254816229374298092666443721045360166266971057148604997386356624038240668235107712529240524107552963148579654572547833749063389636837577841202054588241434584936159115145602333987401556143783
c2=2
m2=113401540113821345700242777769720244794151624423507973591063876634604671137631116037510885574681207963673696269855216233468269397545551444260359829527253831457420973924729412922610332185503573996882241670726316208529184840024767822712265303756172124907909237431678383103779926684625942083332602732367227681669561706192112517456192063050074727439569468144243476415668437114212036788464874702559003824628914759792248724954055918731253023380762983495148028075671728687572003966967259842857690218678487510824808004780311512460064709709259310889908819291707412073772195119803522537298421216162439367053004280127122673572259127857765765904898679636625536815324364469548572569048949267303808293585484033718152035383185647346365378437707517882778064957343400072196129188598939711
X=(c*(2**e))%n
print(X)
X=201496365388179103378899156013980103022731335148601668505252910882870095927246738886171960095850927112954544588781477241376365794298677728858396523519651046323053867916748075711655947250573130576992941299607628622445131049870544780928248391740897724418622682977509863879877975853517811283969226372151227541399577916002591797996660816049125610080889687934793911691437747885856246940512944979980542809282771685277605240273301611869313220216610853097013869616566582578663099540729229152541150083089375055483460537290079754109836217517399763344697621352935346124656157155070714500485165554866754921242513404281412739567181539806333895206099613183488991535948856739312605639783736058676689765846293527602692256947006004413120550668712352546463735610156042305136501282133624415
Y=168694148842372682980691992686900206084794336453665979592071596106460365281714
M=(Y*gmpy2.invert(2,n))%n
print(M)
M=84347074421186341490345996343450103042397168226832989796035798053230182640857


